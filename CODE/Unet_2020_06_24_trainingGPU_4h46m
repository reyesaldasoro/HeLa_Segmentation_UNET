Training on single GPU.
Initializing input data normalization.
|========================================================================================|
|  Epoch  |  Iteration  |  Time Elapsed  |  Mini-batch  |  Mini-batch  |  Base Learning  |
|         |             |   (hh:mm:ss)   |   Accuracy   |     Loss     |      Rate       |
|========================================================================================|
|       1 |           1 |       00:00:03 |       24.48% |       1.3920 |          0.0010 |
|       1 |          50 |       00:01:39 |       76.95% |       0.4741 |          0.0010 |
|       1 |         100 |       00:03:12 |       87.17% |       0.3513 |          0.0010 |
|       1 |         150 |       00:04:46 |       84.84% |       0.4121 |          0.0010 |
|       1 |         200 |       00:06:20 |       86.69% |       0.3782 |          0.0010 |
|       1 |         250 |       00:07:54 |       86.25% |       0.3755 |          0.0010 |
|       1 |         300 |       00:09:29 |       89.96% |       0.2903 |          0.0010 |
|       1 |         350 |       00:11:05 |       88.00% |       0.3062 |          0.0010 |
|       1 |         400 |       00:12:44 |       90.46% |       0.2500 |          0.0010 |
|       1 |         450 |       00:14:23 |       91.23% |       0.2477 |          0.0010 |
|       1 |         500 |       00:16:00 |       88.79% |       0.2846 |          0.0010 |
|       1 |         550 |       00:17:38 |       88.45% |       0.3079 |          0.0010 |
|       2 |         600 |       00:19:20 |       89.29% |       0.2884 |          0.0010 |
|       2 |         650 |       00:21:02 |       88.16% |       0.3460 |          0.0010 |
|       2 |         700 |       00:22:39 |       90.28% |       0.2528 |          0.0010 |
|       2 |         750 |       00:24:13 |       89.81% |       0.2658 |          0.0010 |
|       2 |         800 |       00:25:49 |       91.93% |       0.2145 |          0.0010 |
|       2 |         850 |       00:27:25 |       89.61% |       0.2555 |          0.0010 |
|       2 |         900 |       00:29:01 |       92.43% |       0.1982 |          0.0010 |
|       2 |         950 |       00:30:38 |       91.35% |       0.2104 |          0.0010 |
|       2 |        1000 |       00:32:15 |       90.83% |       0.2510 |          0.0010 |
|       2 |        1050 |       00:34:03 |       92.74% |       0.1968 |          0.0010 |
|       2 |        1100 |       00:35:49 |       90.31% |       0.2737 |          0.0010 |
|       3 |        1150 |       00:37:40 |       92.15% |       0.2043 |          0.0010 |
|       3 |        1200 |       00:39:24 |       93.58% |       0.1604 |          0.0010 |
|       3 |        1250 |       00:41:07 |       92.21% |       0.2039 |          0.0010 |
|       3 |        1300 |       00:42:49 |       94.26% |       0.1564 |          0.0010 |
|       3 |        1350 |       00:44:29 |       93.01% |       0.1756 |          0.0010 |
|       3 |        1400 |       00:46:12 |       93.00% |       0.1853 |          0.0010 |
|       3 |        1450 |       00:47:50 |       91.59% |       0.2202 |          0.0010 |
|       3 |        1500 |       00:49:29 |       91.52% |       0.2109 |          0.0010 |
|       3 |        1550 |       00:51:09 |       90.51% |       0.2291 |          0.0010 |
|       3 |        1600 |       00:52:48 |       93.77% |       0.1732 |          0.0010 |
|       3 |        1650 |       00:54:32 |       92.34% |       0.1963 |          0.0010 |
|       4 |        1700 |       00:56:17 |       91.87% |       0.2159 |          0.0010 |
|       4 |        1750 |       00:57:58 |       95.01% |       0.1458 |          0.0010 |
|       4 |        1800 |       00:59:39 |       92.74% |       0.1961 |          0.0010 |
|       4 |        1850 |       01:01:20 |       92.20% |       0.2080 |          0.0010 |
|       4 |        1900 |       01:02:59 |       91.80% |       0.2109 |          0.0010 |
|       4 |        1950 |       01:04:42 |       90.92% |       0.2238 |          0.0010 |
|       4 |        2000 |       01:06:24 |       91.37% |       0.2147 |          0.0010 |
|       4 |        2050 |       01:08:02 |       92.57% |       0.1956 |          0.0010 |
|       4 |        2100 |       01:09:43 |       92.52% |       0.1925 |          0.0010 |
|       4 |        2150 |       01:11:23 |       90.41% |       0.2396 |          0.0010 |
|       4 |        2200 |       01:13:06 |       94.79% |       0.1463 |          0.0010 |
|       5 |        2250 |       01:14:57 |       94.33% |       0.1521 |          0.0010 |
|       5 |        2300 |       01:16:36 |       94.00% |       0.1666 |          0.0010 |
|       5 |        2350 |       01:18:14 |       93.10% |       0.1785 |          0.0010 |
|       5 |        2400 |       01:19:54 |       94.35% |       0.1484 |          0.0010 |
|       5 |        2450 |       01:21:37 |       94.01% |       0.1538 |          0.0010 |
|       5 |        2500 |       01:23:17 |       93.80% |       0.1707 |          0.0010 |
|       5 |        2550 |       01:24:57 |       91.50% |       0.2305 |          0.0010 |
|       5 |        2600 |       01:26:46 |       91.74% |       0.2134 |          0.0010 |
|       5 |        2650 |       01:28:30 |       92.88% |       0.1975 |          0.0010 |
|       5 |        2700 |       01:30:08 |       94.22% |       0.1629 |          0.0010 |
|       5 |        2750 |       01:31:57 |       93.59% |       0.1697 |          0.0010 |
|       5 |        2800 |       01:33:40 |       91.18% |       0.2098 |          0.0010 |
|       6 |        2850 |       01:35:27 |       93.19% |       0.1814 |          0.0010 |
|       6 |        2900 |       01:37:09 |       92.70% |       0.1919 |          0.0010 |
|       6 |        2950 |       01:38:51 |       93.30% |       0.1798 |          0.0010 |
|       6 |        3000 |       01:40:32 |       94.27% |       0.1495 |          0.0010 |
|       6 |        3050 |       01:42:10 |       93.95% |       0.1682 |          0.0010 |
|       6 |        3100 |       01:43:51 |       91.00% |       0.2164 |          0.0010 |
|       6 |        3150 |       01:45:36 |       92.97% |       0.1668 |          0.0010 |
|       6 |        3200 |       01:47:23 |       92.50% |       0.1739 |          0.0010 |
|       6 |        3250 |       01:49:04 |       94.61% |       0.1503 |          0.0010 |
|       6 |        3300 |       01:50:43 |       93.37% |       0.1668 |          0.0010 |
|       6 |        3350 |       01:52:22 |       92.71% |       0.1763 |          0.0010 |
|       7 |        3400 |       01:54:04 |       95.53% |       0.1229 |          0.0010 |
|       7 |        3450 |       01:55:44 |       93.91% |       0.1533 |          0.0010 |
|       7 |        3500 |       01:57:21 |       93.78% |       0.1510 |          0.0010 |
|       7 |        3550 |       01:58:59 |       93.22% |       0.1576 |          0.0010 |
|       7 |        3600 |       02:00:37 |       92.88% |       0.1692 |          0.0010 |
|       7 |        3650 |       02:02:16 |       91.40% |       0.2145 |          0.0010 |
|       7 |        3700 |       02:03:53 |       93.75% |       0.1690 |          0.0010 |
|       7 |        3750 |       02:05:30 |       94.80% |       0.1421 |          0.0010 |
|       7 |        3800 |       02:07:09 |       94.38% |       0.1484 |          0.0010 |
|       7 |        3850 |       02:08:49 |       94.38% |       0.1600 |          0.0010 |
|       7 |        3900 |       02:10:27 |       91.75% |       0.1889 |          0.0010 |
|       8 |        3950 |       02:12:10 |       93.77% |       0.1641 |          0.0010 |
|       8 |        4000 |       02:13:49 |       92.52% |       0.1830 |          0.0010 |
|       8 |        4050 |       02:15:24 |       92.89% |       0.1726 |          0.0010 |
|       8 |        4100 |       02:17:01 |       93.10% |       0.1656 |          0.0010 |
|       8 |        4150 |       02:18:40 |       93.48% |       0.1784 |          0.0010 |
|       8 |        4200 |       02:20:15 |       90.94% |       0.2239 |          0.0010 |
|       8 |        4250 |       02:21:51 |       92.87% |       0.1801 |          0.0010 |
|       8 |        4300 |       02:23:28 |       93.96% |       0.1602 |          0.0010 |
|       8 |        4350 |       02:25:05 |       93.18% |       0.1822 |          0.0010 |
|       8 |        4400 |       02:26:42 |       93.74% |       0.1650 |          0.0010 |
|       8 |        4450 |       02:28:20 |       92.06% |       0.2134 |          0.0010 |
|       9 |        4500 |       02:29:57 |       92.95% |       0.2154 |          0.0010 |
|       9 |        4550 |       02:31:35 |       94.78% |       0.1427 |          0.0010 |
|       9 |        4600 |       02:33:12 |       94.97% |       0.1346 |          0.0010 |
|       9 |        4650 |       02:34:47 |       94.93% |       0.1165 |          0.0010 |
|       9 |        4700 |       02:36:24 |       95.83% |       0.1127 |          0.0010 |
|       9 |        4750 |       02:38:00 |       94.64% |       0.1365 |          0.0010 |
|       9 |        4800 |       02:39:35 |       95.38% |       0.1277 |          0.0010 |
|       9 |        4850 |       02:41:12 |       93.74% |       0.1564 |          0.0010 |
|       9 |        4900 |       02:42:49 |       96.38% |       0.1096 |          0.0010 |
|       9 |        4950 |       02:44:26 |       92.38% |       0.1909 |          0.0010 |
|       9 |        5000 |       02:46:03 |       94.58% |       0.1399 |          0.0010 |
|       9 |        5050 |       02:47:39 |       93.94% |       0.1507 |          0.0010 |
|      10 |        5100 |       02:49:16 |       94.10% |       0.1670 |          0.0010 |
|      10 |        5150 |       02:50:55 |       95.42% |       0.1309 |          0.0010 |
|      10 |        5200 |       02:52:34 |       93.71% |       0.1777 |          0.0010 |
|      10 |        5250 |       02:54:11 |       90.68% |       0.2386 |          0.0010 |
|      10 |        5300 |       02:55:49 |       94.88% |       0.1346 |          0.0010 |
|      10 |        5350 |       02:57:25 |       95.07% |       0.1230 |          0.0010 |
|      10 |        5400 |       02:59:03 |       92.47% |       0.1787 |          0.0010 |
|      10 |        5450 |       03:00:39 |       94.81% |       0.1349 |          0.0010 |
|      10 |        5500 |       03:02:19 |       92.26% |       0.1841 |          0.0010 |
|      10 |        5550 |       03:04:00 |       94.36% |       0.1457 |          0.0010 |
|      10 |        5600 |       03:05:36 |       93.91% |       0.1559 |          0.0010 |
|      11 |        5650 |       03:07:13 |       94.70% |       0.1390 |          0.0010 |
|      11 |        5700 |       03:08:51 |       93.85% |       0.1683 |          0.0010 |
|      11 |        5750 |       03:10:28 |       94.58% |       0.1527 |          0.0010 |
|      11 |        5800 |       03:12:07 |       95.24% |       0.1267 |          0.0010 |
|      11 |        5850 |       03:13:45 |       94.04% |       0.1612 |          0.0010 |
|      11 |        5900 |       03:15:22 |       94.00% |       0.1455 |          0.0010 |
|      11 |        5950 |       03:17:17 |       95.06% |       0.1323 |          0.0010 |
|      11 |        6000 |       03:19:07 |       95.06% |       0.1434 |          0.0010 |
|      11 |        6050 |       03:21:04 |       92.68% |       0.2045 |          0.0010 |
|      11 |        6100 |       03:23:01 |       92.06% |       0.2224 |          0.0010 |
|      11 |        6150 |       03:24:49 |       94.69% |       0.1378 |          0.0010 |
|      12 |        6200 |       03:27:14 |       94.81% |       0.1351 |          0.0010 |
|      12 |        6250 |       03:29:09 |       94.26% |       0.1570 |          0.0010 |
|      12 |        6300 |       03:31:22 |       94.44% |       0.1550 |          0.0010 |
|      12 |        6350 |       03:33:41 |       93.62% |       0.1591 |          0.0010 |
|      12 |        6400 |       03:35:49 |       95.55% |       0.1226 |          0.0010 |
|      12 |        6450 |       03:38:03 |       96.15% |       0.1081 |          0.0010 |
|      12 |        6500 |       03:40:06 |       93.82% |       0.1680 |          0.0010 |
|      12 |        6550 |       03:42:03 |       95.42% |       0.1213 |          0.0010 |
|      12 |        6600 |       03:43:59 |       95.64% |       0.1145 |          0.0010 |
|      12 |        6650 |       03:45:41 |       94.60% |       0.1494 |          0.0010 |
|      12 |        6700 |       03:47:24 |       95.54% |       0.1206 |          0.0010 |
|      13 |        6750 |       03:49:10 |       94.07% |       0.1538 |          0.0010 |
|      13 |        6800 |       03:50:52 |       95.29% |       0.1259 |          0.0010 |
|      13 |        6850 |       03:52:34 |       93.44% |       0.1788 |          0.0010 |
|      13 |        6900 |       03:54:19 |       94.67% |       0.1362 |          0.0010 |
|      13 |        6950 |       03:55:59 |       94.50% |       0.1460 |          0.0010 |
|      13 |        7000 |       03:57:40 |       94.86% |       0.1466 |          0.0010 |
|      13 |        7050 |       03:59:25 |       95.51% |       0.1257 |          0.0010 |
|      13 |        7100 |       04:01:09 |       93.47% |       0.1628 |          0.0010 |
|      13 |        7150 |       04:02:50 |       93.69% |       0.1588 |          0.0010 |
|      13 |        7200 |       04:04:33 |       92.58% |       0.1865 |          0.0010 |
|      13 |        7250 |       04:06:18 |       93.03% |       0.1802 |          0.0010 |
|      13 |        7300 |       04:08:00 |       93.77% |       0.1463 |          0.0010 |
|      14 |        7350 |       04:09:45 |       94.60% |       0.1381 |          0.0010 |
|      14 |        7400 |       04:11:26 |       96.38% |       0.0977 |          0.0010 |
|      14 |        7450 |       04:13:07 |       94.53% |       0.1345 |          0.0010 |
|      14 |        7500 |       04:14:51 |       95.48% |       0.1222 |          0.0010 |
|      14 |        7550 |       04:16:39 |       94.53% |       0.1349 |          0.0010 |
|      14 |        7600 |       04:18:19 |       94.83% |       0.1381 |          0.0010 |
|      14 |        7650 |       04:19:59 |       95.10% |       0.1317 |          0.0010 |
|      14 |        7700 |       04:21:42 |       93.13% |       0.1678 |          0.0010 |
|      14 |        7750 |       04:23:22 |       93.78% |       0.1755 |          0.0010 |
|      14 |        7800 |       04:25:04 |       94.29% |       0.1414 |          0.0010 |
|      14 |        7850 |       04:26:43 |       95.29% |       0.1214 |          0.0010 |
|      15 |        7900 |       04:28:23 |       94.75% |       0.1354 |          0.0010 |
|      15 |        7950 |       04:30:04 |       95.14% |       0.1304 |          0.0010 |
|      15 |        8000 |       04:31:46 |       95.81% |       0.1152 |          0.0010 |
|      15 |        8050 |       04:33:34 |       93.59% |       0.1561 |          0.0010 |
|      15 |        8100 |       04:35:23 |       94.26% |       0.1487 |          0.0010 |
|      15 |        8150 |       04:37:11 |       95.08% |       0.1299 |          0.0010 |
|      15 |        8200 |       04:38:51 |       95.39% |       0.1305 |          0.0010 |
|      15 |        8250 |       04:40:29 |       94.59% |       0.1348 |          0.0010 |
|      15 |        8300 |       04:42:06 |       93.59% |       0.1599 |          0.0010 |
|      15 |        8350 |       04:43:44 |       94.44% |       0.1456 |          0.0010 |
|      15 |        8400 |       04:45:20 |       95.08% |       0.1313 |          0.0010 |
|      15 |        8430 |       04:46:20 |       92.48% |       0.1961 |          0.0010 |
|========================================================================================|
Undefined function or variable 'c4'.

Error in segmentationHeLaUnet (line 205)
            C=[C1 C2; C3 c4];

>> C=[C1 C2; C3 C4];
>> [rows,cols]          = size(currentData);
            
            % Convert from semantic to numeric
            result               = zeros(rows,cols);
            for counterClass=1:numClasses
                %strcat('T',num2str(counterClass))
                %result = result + counterClass*((C==strcat('T',num2str(counterClass))));
                result = result +(counterClass*(C==strcat('T',num2str(counterClass))));
            end
>> sum(sum(result==groundTruth))/rows/cols

ans =

    0.9167

>> sum(sum( (groundTruth==2).*(result==2) )) / sum(sum ( ((groundTruth==2)|(result==2)) ))

ans =

    0.7014

>> imagesc(result)
>> figure
>> imagesc(currData)
Undefined function or variable 'currData'.
 
>> imagesc(currentData)
>> colormap gray
>> colormap jet
>> save net_2020_06_24 net
>> diary Unet_2020_06_24_trainingGPU_4h46mimagesc(net.Layers(1,1).AverageImage)
analyzeNetwork(net)
I = deepDreamImage(net,name,channels, ...
    'PyramidLevels',1);
{Undefined function or variable 'name'.
} 


layer = 2;
name = net.Layers(layer).Name

name =

    'conv_1'

channels = 1:36;
I = deepDreamImage(net,name,channels, ...
    'PyramidLevels',1);
|==============================================|
|  Iteration  |  Activation  |  Pyramid Level  |
|             |   Strength   |                 |
|==============================================|
|           1 |         8.57 |               1 |
|           2 |         8.08 |               1 |
|           3 |         7.58 |               1 |
|           4 |         7.09 |               1 |
|           5 |         6.59 |               1 |
|           6 |         6.10 |               1 |
|           7 |         5.60 |               1 |
|           8 |         5.11 |               1 |
|           9 |         4.61 |               1 |
|          10 |         4.12 |               1 |
|==============================================|
figure
I = imtile(I,'ThumbnailSize',[64 64]);
imshow(I)
title(['Layer ',name,' Features'],'Interpreter','none')
layer = 6;
name = net.Layers(layer).Name

name =

    'relu_2'

channels = 1:36;
I = deepDreamImage(net,name,channels, ...
    'Verbose',false, ...
    'PyramidLevels',1);
figure
I = imtile(I,'ThumbnailSize',[64 64]);
imshow(I)
name = net.Layers(layer).Name;
title(['Layer ',name,' Features'],'Interpreter','none')
layer = 16;
name = net.Layers(layer).Name

name =

    'conv_6'

channels = 1:36;
I = deepDreamImage(net,name,channels, ...
    'Verbose',false, ...
    'PyramidLevels',1);
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deepDreamImage')" style="font-weight:bold">deepDreamImage</a>
Expected input number 3, channel, to be an array with all
of the values <= 4.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deepDreamImage>iCheckChannels', 'C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m', 288)" style="font-weight:bold">deepDreamImage>iCheckChannels</a> (<a href="matlab: opentoline('C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m',288,0)">line 288</a>)
validateattributes(channels, {'numeric'}, ...

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deepDreamImage>iParseInputs', 'C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m', 211)" style="font-weight:bold">deepDreamImage>iParseInputs</a> (<a href="matlab: opentoline('C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m',211,0)">line 211</a>)
iCheckChannels(net.Layers, layerIdx, channels);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deepDreamImage', 'C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m', 144)" style="font-weight:bold">deepDreamImage</a> (<a href="matlab: opentoline('C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m',144,0)">line 144</a>)
[layerIdx, params] = iParseInputs(net, layer, channels,
varargin{:});
} 

channels = 1:4;
channels = 1:36;
I = deepDreamImage(net,name,channels, ...
    'Verbose',false, ...
    'PyramidLevels',1);
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deepDreamImage')" style="font-weight:bold">deepDreamImage</a>
Expected input number 3, channel, to be an array with all
of the values <= 4.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deepDreamImage>iCheckChannels', 'C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m', 288)" style="font-weight:bold">deepDreamImage>iCheckChannels</a> (<a href="matlab: opentoline('C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m',288,0)">line 288</a>)
validateattributes(channels, {'numeric'}, ...

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deepDreamImage>iParseInputs', 'C:\Program Files\MATLAB\R2019a\toolbox\nnet\cnn\deepDreamImage.m', 211)" style="font-weight:bold">deepDrea